@model DashboardModel
@{
    Layout = "_AdminLayout";
    ViewBag.PageTitle = T("Plugins.Misc.PaymentGuard.Menu.Dashboard").Text;

    //active menu item (system name)
    NopHtml.SetActiveMenuItemSystemName("PaymentGuard.Menu.Dashboard");
}

@{
    var complianceScoreClass = Model.ComplianceScore >= 95 ? "success" : Model.ComplianceScore >= 80 ? "warning" : "danger";
    var complianceScoreText = Model.ComplianceScore >= 95 ? "Plugins.Misc.PaymentGuard.Dashboard.ComplianceExcellent" : Model.ComplianceScore >= 80 ? "Plugins.Misc.PaymentGuard.Dashboard.ComplianceGood" : "Plugins.Misc.PaymentGuard.Dashboard.ComplianceNeedsAttention";
}
<div class="content-header clearfix">
    <h1 class="float-left">
        @T("Plugins.Misc.PaymentGuard.Menu.Dashboard")
    </h1>
    <div class="float-right">
        <a asp-action="List" class="btn btn-primary">
            <i class="fas fa-list"></i>
            @T("Plugins.Misc.PaymentGuard.ManageScripts")
        </a>
    </div>
</div>

<section class="content">
    <div class="container-fluid">
        <!-- Stats Cards -->
        <div class="row">
            <div class="col-lg-3 col-6">
                <div class="small-box bg-info">
                    <div class="inner">
                        <h3>@Model.TotalScriptsMonitored</h3>
                        <p>@T("Plugins.Misc.PaymentGuard.Dashboard.TotalScriptsMonitoredLabel")</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-code"></i>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box bg-success">
                    <div class="inner">
                        <h3>@Model.AuthorizedScriptsCount</h3>
                        <p>@T("Plugins.Misc.PaymentGuard.Dashboard.AuthorizedScriptsLabel")</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-check-shield"></i>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box bg-warning">
                    <div class="inner">
                        <h3>@Model.UnauthorizedScriptsCount</h3>
                        <p>@T("Plugins.Misc.PaymentGuard.Dashboard.UnauthorizedScriptsLabel")</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box bg-@(complianceScoreClass)">
                    <div class="inner">
                        <h3>@Model.ComplianceScore.ToString("F1")%</h3>
                        <p>@T("Plugins.Misc.PaymentGuard.Dashboard.ComplianceScoreLabel")</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Compliance Overview -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-bar"></i>
                            @T("Plugins.Misc.PaymentGuard.Dashboard.ComplianceOverview")
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="progress progress-sm">
                                    <div class="progress-bar bg-@(complianceScoreClass)" style="width: @Model.ComplianceScore%"></div>
                                </div>
                                <small>
                                    @T("Plugins.Misc.PaymentGuard.Dashboard.ComplianceOverview.Score"): <strong>@Model.ComplianceScore.ToString("F1")%</strong> (@T(complianceScoreText))
                                </small>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="description-block border-right">
                                    <span class="description-percentage text-success">
                                        <i class="fas fa-caret-up"></i> @Model.AuthorizedScriptsCount
                                    </span>
                                    <h5 class="description-header">@Model.AuthorizedScriptsCount</h5>
                                    <span class="description-text">@T("Plugins.Misc.PaymentGuard.Dashboard.Authorized")</span>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="description-block border-right">
                                    <span class="description-percentage text-warning">
                                        <i class="fas fa-caret-down"></i> @Model.UnauthorizedScriptsCount
                                    </span>
                                    <h5 class="description-header">@Model.UnauthorizedScriptsCount</h5>
                                    <span class="description-text">@T("Plugins.Misc.PaymentGuard.Dashboard.Unauthorized")</span>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="description-block">
                                    <span class="description-percentage text-info">
                                        <i class="fas fa-caret-up"></i> @Model.TotalChecksPerformed
                                    </span>
                                    <h5 class="description-header">@Model.TotalChecksPerformed</h5>
                                    <span class="description-text">@T("Plugins.Misc.PaymentGuard.Dashboard.Checks")</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-clock"></i>
                            @T("Plugins.Misc.PaymentGuard.Dashboard.RecentActivity")
                        </h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled">
                            <li>
                                <i class="fas fa-check text-success"></i>
                                @T("Plugins.Misc.PaymentGuard.Dashboard.LastMonitoringCheck") <strong>@Model.LastCheckDate.ToString("MMM dd, yyyy HH:mm")</strong>
                            </li>
                            <li>
                                <i class="fas fa-bell text-info"></i>
                                @T("Plugins.Misc.PaymentGuard.Dashboard.TotalAlertsGenerated") <strong>@Model.AlertsGenerated</strong>
                            </li>
                            <li>
                                <i class="fas fa-shield-alt text-primary"></i>
                                @T("Plugins.Misc.PaymentGuard.Dashboard.ScriptsUnderProtection") <strong>@Model.TotalScriptsMonitored</strong>
                            </li>
                        </ul>

                        @if (Model.MostCommonUnauthorizedScripts.Any())
                        {
                            <hr>
                            <h6><i class="fas fa-exclamation-triangle text-warning"></i> @T("Plugins.Misc.PaymentGuard.Dashboard.MostCommonUnauthorizedScripts")</h6>
                            <ul class="list-unstyled">
                                @foreach (var script in Model.MostCommonUnauthorizedScripts.Take(5))
                                {
                                    <li><small><code>@script</code></small></li>
                                }
                            </ul>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>